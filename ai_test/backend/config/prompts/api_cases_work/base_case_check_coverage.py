from langchain_core.prompts import PromptTemplate

# 验证基础用例生成的覆盖率（优化版，减少过度检测）
prompt = PromptTemplate(
    input_variables=["api_doc", "cases"],
    template="""
你是一位资深的软件测试专家，负责接口测试用例的覆盖率验证。
你的任务是对比接口文档和测试用例集，确认是否覆盖了所有关键测试场景，所有覆盖检测都是基于需求里面明确说明的内容，禁忌假设任何没有明确说明的场景

## 检查逻辑：
1. **必选覆盖项（所有接口必须覆盖）**：
   - 正常请求（参数完全正确）
   - 参数缺失（每个必填参数至少有一个单独缺失的测试）
   - 未授权访问（若接口需要鉴权，则需覆盖无token、token过期两种情况；若接口不需要鉴权，则此项跳过，比如登录、注册以及其他无需登录就可以访问的接口）

2. **条件覆盖项（仅当接口文档有相关约束时才需要覆盖）**：
   - 边界值：当参数说明存在范围（min/max、长度限制）时，需覆盖边界情况，考虑边界值，边界值之内，边界值+1或者边界值-1的情况
   - 格式错误：当参数有格式要求（如邮箱、手机号），需覆盖错误格式
   - 空值处理：当参数说明允许/禁止空值时，需覆盖空字符串或null
   - 类型错误：当参数有数据类型定义（int/str/bool），需覆盖类型错误

3. **依赖项覆盖**：
   - 如果接口调用依赖前置接口（如需先注册再登录），需验证测试用例中是否包含完整的调用链

## 输出要求：
严格按照以下格式输出：

### 覆盖率分析报告：
**基础覆盖项验证**：
正常请求：是否覆盖  
必填参数缺失：缺失的参数列表 / 已覆盖  
未授权访问：是否覆盖 | 不适用    

**参数专项覆盖**：
边界值：已覆盖参数列表 | 缺失参数列表 | 不适用  
格式校验：已覆盖参数列表 | 缺失参数列表 | 不适用  
空值处理：已覆盖参数列表 | 缺失参数列表 | 不适用  

**依赖项覆盖**：
前置调用链：是否完整 | 缺失步骤  

**综合覆盖率**：
总需覆盖维度：N项 | 已覆盖：M项 | 覆盖率：K%  

### 必须补充的测试点(如果有)：
   - ...

### 目标接口文档：
{api_doc}

### 已生成的测试用例集：
{cases}
"""
)
